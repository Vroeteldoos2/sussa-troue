{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\drago\\\\OneDrive\\\\Desktop\\\\sussa-troue\\\\src\\\\pages\\\\WeddingAlbumPage.jsx\",\n  _s = $RefreshSig$();\n// File: src/pages/WeddingAlbumPage.jsx\nimport { useEffect, useMemo, useState } from \"react\";\nimport { supabase } from \"../supabaseClient\";\nimport dayjs from \"dayjs\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PAGE_SIZE = 24;\nexport default function WeddingAlbumPage() {\n  _s();\n  const [items, setItems] = useState([]);\n  const [page, setPage] = useState(0);\n  const [hasMore, setHasMore] = useState(true);\n  const [loading, setLoading] = useState(false);\n  const loadPage = async () => {\n    if (loading || !hasMore) return;\n    setLoading(true);\n    const from = page * PAGE_SIZE;\n    const to = from + PAGE_SIZE - 1;\n    const {\n      data,\n      error\n    } = await supabase.from(\"album_files\").select(\"*\").order(\"created_at\", {\n      ascending: false\n    }).range(from, to);\n    if (error) {\n      console.error(error);\n    } else {\n      setItems(prev => [...prev, ...(data || [])]);\n      if (!data || data.length < PAGE_SIZE) setHasMore(false);\n      setPage(p => p + 1);\n    }\n    setLoading(false);\n  };\n  useEffect(() => {\n    loadPage();\n    // eslint-disable-next-line\n  }, []);\n\n  // Group by yyyy-mm-dd\n  const groups = useMemo(() => {\n    const map = {};\n    for (const it of items) {\n      const key = dayjs(it.created_at).format(\"YYYY-MM-DD\");\n      if (!map[key]) map[key] = [];\n      map[key].push(it);\n    }\n    return Object.entries(map).sort(([a], [b]) => a < b ? 1 : -1);\n  }, [items]);\n\n  // Infinite scroll\n  useEffect(() => {\n    const onScroll = () => {\n      const nearBottom = window.innerHeight + window.scrollY >= document.body.offsetHeight - 300;\n      if (nearBottom) loadPage();\n    };\n    window.addEventListener(\"scroll\", onScroll);\n    return () => window.removeEventListener(\"scroll\", onScroll);\n    // eslint-disable-next-line\n  }, [page, hasMore, loading]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-950 text-gray-100 px-4 py-8\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-6xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-3xl font-bold mb-6\",\n        children: \"Wedding Album\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-8\",\n        children: groups.map(([date, arr]) => /*#__PURE__*/_jsxDEV(\"section\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold mb-3\",\n            children: dayjs(date).format(\"DD MMM YYYY\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3\",\n            children: arr.map(it => /*#__PURE__*/_jsxDEV(\"a\", {\n              href: it.preview_url,\n              target: \"_blank\",\n              rel: \"noreferrer\",\n              className: \"block group rounded-xl overflow-hidden bg-gray-900 border border-gray-800\",\n              title: `${it.drive_name} — Uploaded by ${it.uploader_name || \"Guest\"}`,\n              children: [it.media_type === \"image\" ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: it.preview_url,\n                alt: it.drive_name,\n                className: \"w-full h-40 object-cover group-hover:opacity-90\",\n                loading: \"lazy\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 23\n              }, this) : it.media_type === \"video\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-full h-40 flex items-center justify-center text-sm text-gray-300\",\n                children: \"Open video \\u2197\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 23\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-full h-40 flex items-center justify-center text-sm text-gray-400\",\n                children: \"File\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 93,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"p-2 text-xs text-gray-300 flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"truncate\",\n                  children: it.uploader_name || \"Guest\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 98,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: dayjs(it.created_at).format(\"HH:mm\")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 99,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 97,\n                columnNumber: 21\n              }, this)]\n            }, it.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 73,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 15\n          }, this)]\n        }, date, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6 text-gray-400\",\n        children: \"Loading\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 21\n      }, this), !hasMore && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6 text-gray-500\",\n        children: \"End of album.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 22\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n}\n_s(WeddingAlbumPage, \"/iSDleneFdsA1sXcTRh1Pp88FRc=\");\n_c = WeddingAlbumPage;\nvar _c;\n$RefreshReg$(_c, \"WeddingAlbumPage\");","map":{"version":3,"names":["useEffect","useMemo","useState","supabase","dayjs","jsxDEV","_jsxDEV","PAGE_SIZE","WeddingAlbumPage","_s","items","setItems","page","setPage","hasMore","setHasMore","loading","setLoading","loadPage","from","to","data","error","select","order","ascending","range","console","prev","length","p","groups","map","it","key","created_at","format","push","Object","entries","sort","a","b","onScroll","nearBottom","window","innerHeight","scrollY","document","body","offsetHeight","addEventListener","removeEventListener","className","children","fileName","_jsxFileName","lineNumber","columnNumber","date","arr","href","preview_url","target","rel","title","drive_name","uploader_name","media_type","src","alt","id","_c","$RefreshReg$"],"sources":["C:/Users/drago/OneDrive/Desktop/sussa-troue/src/pages/WeddingAlbumPage.jsx"],"sourcesContent":["// File: src/pages/WeddingAlbumPage.jsx\nimport { useEffect, useMemo, useState } from \"react\";\nimport { supabase } from \"../supabaseClient\";\nimport dayjs from \"dayjs\";\n\nconst PAGE_SIZE = 24;\n\nexport default function WeddingAlbumPage() {\n  const [items, setItems] = useState([]);\n  const [page, setPage] = useState(0);\n  const [hasMore, setHasMore] = useState(true);\n  const [loading, setLoading] = useState(false);\n\n  const loadPage = async () => {\n    if (loading || !hasMore) return;\n    setLoading(true);\n    const from = page * PAGE_SIZE;\n    const to = from + PAGE_SIZE - 1;\n\n    const { data, error } = await supabase\n      .from(\"album_files\")\n      .select(\"*\")\n      .order(\"created_at\", { ascending: false })\n      .range(from, to);\n\n    if (error) {\n      console.error(error);\n    } else {\n      setItems((prev) => [...prev, ...(data || [])]);\n      if (!data || data.length < PAGE_SIZE) setHasMore(false);\n      setPage((p) => p + 1);\n    }\n    setLoading(false);\n  };\n\n  useEffect(() => {\n    loadPage();\n    // eslint-disable-next-line\n  }, []);\n\n  // Group by yyyy-mm-dd\n  const groups = useMemo(() => {\n    const map = {};\n    for (const it of items) {\n      const key = dayjs(it.created_at).format(\"YYYY-MM-DD\");\n      if (!map[key]) map[key] = [];\n      map[key].push(it);\n    }\n    return Object.entries(map).sort(([a], [b]) => (a < b ? 1 : -1));\n  }, [items]);\n\n  // Infinite scroll\n  useEffect(() => {\n    const onScroll = () => {\n      const nearBottom = window.innerHeight + window.scrollY >= document.body.offsetHeight - 300;\n      if (nearBottom) loadPage();\n    };\n    window.addEventListener(\"scroll\", onScroll);\n    return () => window.removeEventListener(\"scroll\", onScroll);\n    // eslint-disable-next-line\n  }, [page, hasMore, loading]);\n\n  return (\n    <div className=\"min-h-screen bg-gray-950 text-gray-100 px-4 py-8\">\n      <div className=\"max-w-6xl mx-auto\">\n        <h1 className=\"text-3xl font-bold mb-6\">Wedding Album</h1>\n        <div className=\"space-y-8\">\n          {groups.map(([date, arr]) => (\n            <section key={date}>\n              <h2 className=\"text-xl font-semibold mb-3\">{dayjs(date).format(\"DD MMM YYYY\")}</h2>\n              <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3\">\n                {arr.map((it) => (\n                  <a\n                    key={it.id}\n                    href={it.preview_url}\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                    className=\"block group rounded-xl overflow-hidden bg-gray-900 border border-gray-800\"\n                    title={`${it.drive_name} — Uploaded by ${it.uploader_name || \"Guest\"}`}\n                  >\n                    {it.media_type === \"image\" ? (\n                      <img\n                        src={it.preview_url}\n                        alt={it.drive_name}\n                        className=\"w-full h-40 object-cover group-hover:opacity-90\"\n                        loading=\"lazy\"\n                      />\n                    ) : it.media_type === \"video\" ? (\n                      <div className=\"w-full h-40 flex items-center justify-center text-sm text-gray-300\">\n                        Open video ↗\n                      </div>\n                    ) : (\n                      <div className=\"w-full h-40 flex items-center justify-center text-sm text-gray-400\">\n                        File\n                      </div>\n                    )}\n                    <div className=\"p-2 text-xs text-gray-300 flex justify-between\">\n                      <span className=\"truncate\">{it.uploader_name || \"Guest\"}</span>\n                      <span>{dayjs(it.created_at).format(\"HH:mm\")}</span>\n                    </div>\n                  </a>\n                ))}\n              </div>\n            </section>\n          ))}\n        </div>\n\n        {loading && <p className=\"mt-6 text-gray-400\">Loading…</p>}\n        {!hasMore && <p className=\"mt-6 text-gray-500\">End of album.</p>}\n      </div>\n    </div>\n  );\n}\n"],"mappings":";;AAAA;AACA,SAASA,SAAS,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AACpD,SAASC,QAAQ,QAAQ,mBAAmB;AAC5C,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1B,MAAMC,SAAS,GAAG,EAAE;AAEpB,eAAe,SAASC,gBAAgBA,CAAA,EAAG;EAAAC,EAAA;EACzC,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGT,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACU,IAAI,EAAEC,OAAO,CAAC,GAAGX,QAAQ,CAAC,CAAC,CAAC;EACnC,MAAM,CAACY,OAAO,EAAEC,UAAU,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACc,OAAO,EAAEC,UAAU,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;EAE7C,MAAMgB,QAAQ,GAAG,MAAAA,CAAA,KAAY;IAC3B,IAAIF,OAAO,IAAI,CAACF,OAAO,EAAE;IACzBG,UAAU,CAAC,IAAI,CAAC;IAChB,MAAME,IAAI,GAAGP,IAAI,GAAGL,SAAS;IAC7B,MAAMa,EAAE,GAAGD,IAAI,GAAGZ,SAAS,GAAG,CAAC;IAE/B,MAAM;MAAEc,IAAI;MAAEC;IAAM,CAAC,GAAG,MAAMnB,QAAQ,CACnCgB,IAAI,CAAC,aAAa,CAAC,CACnBI,MAAM,CAAC,GAAG,CAAC,CACXC,KAAK,CAAC,YAAY,EAAE;MAAEC,SAAS,EAAE;IAAM,CAAC,CAAC,CACzCC,KAAK,CAACP,IAAI,EAAEC,EAAE,CAAC;IAElB,IAAIE,KAAK,EAAE;MACTK,OAAO,CAACL,KAAK,CAACA,KAAK,CAAC;IACtB,CAAC,MAAM;MACLX,QAAQ,CAAEiB,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAE,IAAIP,IAAI,IAAI,EAAE,CAAC,CAAC,CAAC;MAC9C,IAAI,CAACA,IAAI,IAAIA,IAAI,CAACQ,MAAM,GAAGtB,SAAS,EAAEQ,UAAU,CAAC,KAAK,CAAC;MACvDF,OAAO,CAAEiB,CAAC,IAAKA,CAAC,GAAG,CAAC,CAAC;IACvB;IACAb,UAAU,CAAC,KAAK,CAAC;EACnB,CAAC;EAEDjB,SAAS,CAAC,MAAM;IACdkB,QAAQ,CAAC,CAAC;IACV;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMa,MAAM,GAAG9B,OAAO,CAAC,MAAM;IAC3B,MAAM+B,GAAG,GAAG,CAAC,CAAC;IACd,KAAK,MAAMC,EAAE,IAAIvB,KAAK,EAAE;MACtB,MAAMwB,GAAG,GAAG9B,KAAK,CAAC6B,EAAE,CAACE,UAAU,CAAC,CAACC,MAAM,CAAC,YAAY,CAAC;MACrD,IAAI,CAACJ,GAAG,CAACE,GAAG,CAAC,EAAEF,GAAG,CAACE,GAAG,CAAC,GAAG,EAAE;MAC5BF,GAAG,CAACE,GAAG,CAAC,CAACG,IAAI,CAACJ,EAAE,CAAC;IACnB;IACA,OAAOK,MAAM,CAACC,OAAO,CAACP,GAAG,CAAC,CAACQ,IAAI,CAAC,CAAC,CAACC,CAAC,CAAC,EAAE,CAACC,CAAC,CAAC,KAAMD,CAAC,GAAGC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAE,CAAC;EACjE,CAAC,EAAE,CAAChC,KAAK,CAAC,CAAC;;EAEX;EACAV,SAAS,CAAC,MAAM;IACd,MAAM2C,QAAQ,GAAGA,CAAA,KAAM;MACrB,MAAMC,UAAU,GAAGC,MAAM,CAACC,WAAW,GAAGD,MAAM,CAACE,OAAO,IAAIC,QAAQ,CAACC,IAAI,CAACC,YAAY,GAAG,GAAG;MAC1F,IAAIN,UAAU,EAAE1B,QAAQ,CAAC,CAAC;IAC5B,CAAC;IACD2B,MAAM,CAACM,gBAAgB,CAAC,QAAQ,EAAER,QAAQ,CAAC;IAC3C,OAAO,MAAME,MAAM,CAACO,mBAAmB,CAAC,QAAQ,EAAET,QAAQ,CAAC;IAC3D;EACF,CAAC,EAAE,CAAC/B,IAAI,EAAEE,OAAO,EAAEE,OAAO,CAAC,CAAC;EAE5B,oBACEV,OAAA;IAAK+C,SAAS,EAAC,kDAAkD;IAAAC,QAAA,eAC/DhD,OAAA;MAAK+C,SAAS,EAAC,mBAAmB;MAAAC,QAAA,gBAChChD,OAAA;QAAI+C,SAAS,EAAC,yBAAyB;QAAAC,QAAA,EAAC;MAAa;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC1DpD,OAAA;QAAK+C,SAAS,EAAC,WAAW;QAAAC,QAAA,EACvBvB,MAAM,CAACC,GAAG,CAAC,CAAC,CAAC2B,IAAI,EAAEC,GAAG,CAAC,kBACtBtD,OAAA;UAAAgD,QAAA,gBACEhD,OAAA;YAAI+C,SAAS,EAAC,4BAA4B;YAAAC,QAAA,EAAElD,KAAK,CAACuD,IAAI,CAAC,CAACvB,MAAM,CAAC,aAAa;UAAC;YAAAmB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACnFpD,OAAA;YAAK+C,SAAS,EAAC,sDAAsD;YAAAC,QAAA,EAClEM,GAAG,CAAC5B,GAAG,CAAEC,EAAE,iBACV3B,OAAA;cAEEuD,IAAI,EAAE5B,EAAE,CAAC6B,WAAY;cACrBC,MAAM,EAAC,QAAQ;cACfC,GAAG,EAAC,YAAY;cAChBX,SAAS,EAAC,2EAA2E;cACrFY,KAAK,EAAE,GAAGhC,EAAE,CAACiC,UAAU,kBAAkBjC,EAAE,CAACkC,aAAa,IAAI,OAAO,EAAG;cAAAb,QAAA,GAEtErB,EAAE,CAACmC,UAAU,KAAK,OAAO,gBACxB9D,OAAA;gBACE+D,GAAG,EAAEpC,EAAE,CAAC6B,WAAY;gBACpBQ,GAAG,EAAErC,EAAE,CAACiC,UAAW;gBACnBb,SAAS,EAAC,iDAAiD;gBAC3DrC,OAAO,EAAC;cAAM;gBAAAuC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACf,CAAC,GACAzB,EAAE,CAACmC,UAAU,KAAK,OAAO,gBAC3B9D,OAAA;gBAAK+C,SAAS,EAAC,oEAAoE;gBAAAC,QAAA,EAAC;cAEpF;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,gBAENpD,OAAA;gBAAK+C,SAAS,EAAC,oEAAoE;gBAAAC,QAAA,EAAC;cAEpF;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CACN,eACDpD,OAAA;gBAAK+C,SAAS,EAAC,gDAAgD;gBAAAC,QAAA,gBAC7DhD,OAAA;kBAAM+C,SAAS,EAAC,UAAU;kBAAAC,QAAA,EAAErB,EAAE,CAACkC,aAAa,IAAI;gBAAO;kBAAAZ,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eAC/DpD,OAAA;kBAAAgD,QAAA,EAAOlD,KAAK,CAAC6B,EAAE,CAACE,UAAU,CAAC,CAACC,MAAM,CAAC,OAAO;gBAAC;kBAAAmB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChD,CAAC;YAAA,GA1BDzB,EAAE,CAACsC,EAAE;cAAAhB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OA2BT,CACJ;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC;QAAA,GAlCMC,IAAI;UAAAJ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAmCT,CACV;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,EAEL1C,OAAO,iBAAIV,OAAA;QAAG+C,SAAS,EAAC,oBAAoB;QAAAC,QAAA,EAAC;MAAQ;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,EACzD,CAAC5C,OAAO,iBAAIR,OAAA;QAAG+C,SAAS,EAAC,oBAAoB;QAAAC,QAAA,EAAC;MAAa;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC7D;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAACjD,EAAA,CAzGuBD,gBAAgB;AAAAgE,EAAA,GAAhBhE,gBAAgB;AAAA,IAAAgE,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}