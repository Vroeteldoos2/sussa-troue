{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\drago\\\\OneDrive\\\\Desktop\\\\sussa-troue\\\\src\\\\pages\\\\LeaveMessagePage.jsx\",\n  _s = $RefreshSig$();\n// File: src/pages/LeaveMessagePage.jsx\nimport { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { supabase } from \"../supabaseClient\";\nimport { toast } from \"react-hot-toast\";\nimport Backdrop from \"../components/Backdrop\";\nimport Card from \"../components/Card\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MAX_LEN = 500;\nexport default function LeaveMessagePage() {\n  _s();\n  const [text, setText] = useState(\"\");\n  const [submitting, setSubmitting] = useState(false);\n  const [user, setUser] = useState(null);\n  const navigate = useNavigate();\n\n  // Get session user (required to post)\n  useEffect(() => {\n    let cancelled = false;\n    (async _data$session => {\n      const {\n        data,\n        error\n      } = await supabase.auth.getSession();\n      if (!cancelled) setUser(error ? null : (data === null || data === void 0 ? void 0 : (_data$session = data.session) === null || _data$session === void 0 ? void 0 : _data$session.user) || null);\n    })();\n    return () => {\n      cancelled = true;\n    };\n  }, []);\n  const submit = async e => {\n    e.preventDefault();\n    const value = (text || \"\").trim();\n    if (!value) return toast.error(\"Please write a message first.\");\n    if (value.length > MAX_LEN) return toast.error(\"Message is too long.\");\n\n    // Gate: require login (avoids RLS errors that look like ‚Äúnothing happened‚Äù)\n    if (!user) {\n      toast(\"Please log in to leave a message.\");\n      navigate(\"/login\");\n      return;\n    }\n    setSubmitting(true);\n    try {\n      const {\n        error\n      } = await supabase.from(\"guest_messages\").insert([payload]);\n      if (error) throw error;\n      toast.success(\"Message submitted!\");\n      setText(\"\");\n      // Send them to the wall to see their post\n      navigate(\"/message-wall\", {\n        replace: true\n      });\n    } catch (err) {\n      console.error(err);\n      toast.error((err === null || err === void 0 ? void 0 : err.message) || \"Could not submit message.\");\n    } finally {\n      setSubmitting(false);\n    }\n  };\n  const remaining = Math.max(0, MAX_LEN - ((text === null || text === void 0 ? void 0 : text.length) || 0));\n  return /*#__PURE__*/_jsxDEV(Backdrop, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-2xl mx-auto px-4 py-10\",\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        className: \"p-6 text-black\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"section-title\",\n          children: \"Leave a message for Abraham & Jesse\\u2011Lee \\uD83C\\uDF3B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"mt-4 space-y-3\",\n          onSubmit: submit,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block\",\n            htmlFor: \"guest_message\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"sr-only\",\n              children: \"Your message\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 68,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              id: \"guest_message\",\n              className: \"input h-32 w-full\",\n              value: text,\n              onChange: e => setText(e.target.value),\n              placeholder: \"Share your wishes\\u2026\",\n              maxLength: MAX_LEN,\n              \"aria-describedby\": \"msg_help\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 69,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"msg_help\",\n            className: `text-xs ${remaining < 20 ? \"text-red-500\" : \"text-soil-600\"}`,\n            children: [remaining, \" characters left\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-end\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-primary\",\n              type: \"submit\",\n              disabled: submitting,\n              \"aria-busy\": submitting ? \"true\" : \"false\",\n              children: submitting ? \"Submitting‚Ä¶\" : \"Submit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n}\n_s(LeaveMessagePage, \"SRUTc+K6XGIY3jPSqfpvreC542o=\", false, function () {\n  return [useNavigate];\n});\n_c = LeaveMessagePage;\nvar _c;\n$RefreshReg$(_c, \"LeaveMessagePage\");","map":{"version":3,"names":["useEffect","useState","useNavigate","supabase","toast","Backdrop","Card","jsxDEV","_jsxDEV","MAX_LEN","LeaveMessagePage","_s","text","setText","submitting","setSubmitting","user","setUser","navigate","cancelled","_data$session","data","error","auth","getSession","session","submit","e","preventDefault","value","trim","length","from","insert","payload","success","replace","err","console","message","remaining","Math","max","children","className","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","htmlFor","id","onChange","target","placeholder","maxLength","type","disabled","_c","$RefreshReg$"],"sources":["C:/Users/drago/OneDrive/Desktop/sussa-troue/src/pages/LeaveMessagePage.jsx"],"sourcesContent":["// File: src/pages/LeaveMessagePage.jsx\nimport { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { supabase } from \"../supabaseClient\";\nimport { toast } from \"react-hot-toast\";\nimport Backdrop from \"../components/Backdrop\";\nimport Card from \"../components/Card\";\n\nconst MAX_LEN = 500;\n\nexport default function LeaveMessagePage() {\n  const [text, setText] = useState(\"\");\n  const [submitting, setSubmitting] = useState(false);\n  const [user, setUser] = useState(null);\n  const navigate = useNavigate();\n\n  // Get session user (required to post)\n  useEffect(() => {\n    let cancelled = false;\n    (async () => {\n      const { data, error } = await supabase.auth.getSession();\n      if (!cancelled) setUser(error ? null : data?.session?.user || null);\n    })();\n    return () => { cancelled = true; };\n  }, []);\n\n  const submit = async (e) => {\n    e.preventDefault();\n\n    const value = (text || \"\").trim();\n    if (!value) return toast.error(\"Please write a message first.\");\n    if (value.length > MAX_LEN) return toast.error(\"Message is too long.\");\n\n    // Gate: require login (avoids RLS errors that look like ‚Äúnothing happened‚Äù)\n    if (!user) {\n      toast(\"Please log in to leave a message.\");\n      navigate(\"/login\");\n      return;\n    }\n\n    setSubmitting(true);\n    try {\n\n      const { error } = await supabase.from(\"guest_messages\").insert([payload]);\n      if (error) throw error;\n\n      toast.success(\"Message submitted!\");\n      setText(\"\");\n      // Send them to the wall to see their post\n      navigate(\"/message-wall\", { replace: true });\n    } catch (err) {\n      console.error(err);\n      toast.error(err?.message || \"Could not submit message.\");\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const remaining = Math.max(0, MAX_LEN - (text?.length || 0));\n\n  return (\n    <Backdrop>\n      <div className=\"max-w-2xl mx-auto px-4 py-10\">\n        <Card className=\"p-6 text-black\">\n          <h2 className=\"section-title\">Leave a message for Abraham & Jesse‚ÄëLee üåª</h2>\n          <form className=\"mt-4 space-y-3\" onSubmit={submit}>\n            <label className=\"block\" htmlFor=\"guest_message\">\n              <span className=\"sr-only\">Your message</span>\n              <textarea\n                id=\"guest_message\"\n                className=\"input h-32 w-full\"\n                value={text}\n                onChange={(e) => setText(e.target.value)}\n                placeholder=\"Share your wishes‚Ä¶\"\n                maxLength={MAX_LEN}\n                aria-describedby=\"msg_help\"\n              />\n            </label>\n            <div\n              id=\"msg_help\"\n              className={`text-xs ${remaining < 20 ? \"text-red-500\" : \"text-soil-600\"}`}\n            >\n              {remaining} characters left\n            </div>\n\n            <div className=\"flex justify-end\">\n              <button\n                className=\"btn-primary\"\n                type=\"submit\"\n                disabled={submitting}\n                aria-busy={submitting ? \"true\" : \"false\"}\n              >\n                {submitting ? \"Submitting‚Ä¶\" : \"Submit\"}\n              </button>\n            </div>\n          </form>\n        </Card>\n      </div>\n    </Backdrop>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}