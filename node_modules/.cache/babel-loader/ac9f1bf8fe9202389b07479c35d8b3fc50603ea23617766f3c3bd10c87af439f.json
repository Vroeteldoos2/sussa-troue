{"ast":null,"code":"// File: src/pages/MessageWallPage.jsx\nimport{useEffect,useMemo,useState}from\"react\";import{supabase}from\"../supabaseClient\";import Backdrop from\"../components/Backdrop\";import Card from\"../components/Card\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PAGE_SIZE=20;export default function MessageWallPage(){const[messages,setMessages]=useState([]);const[expandedId,setExpandedId]=useState(null);const[loading,setLoading]=useState(true);const[err,setErr]=useState(\"\");const[page,setPage]=useState(1);useEffect(()=>{let mounted=true;(async()=>{setLoading(true);const{data,error}=await supabase.from(\"guest_messages\").select(\"*\").eq(\"approved\",true).eq(\"is_public\",true).order(\"created_at\",{ascending:false});if(!mounted)return;if(error){setErr(error.message||\"Failed to load messages.\");setMessages([]);}else{setMessages(Array.isArray(data)?data:[]);}setLoading(false);})();return()=>{mounted=false;};},[]);const visible=useMemo(()=>{const end=page*PAGE_SIZE;return messages.slice(0,end);},[messages,page]);const toggle=id=>{setExpandedId(cur=>cur===id?null:id);};const hasMore=messages.length>visible.length;return/*#__PURE__*/_jsx(Backdrop,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto px-4 py-10\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"my-6 text-center text-white\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-extrabold\",children:\"Message Wall \\uD83C\\uDF3B\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/80\",children:\"Warm wishes from friends & family\"})]}),loading?/*#__PURE__*/_jsx(Card,{className:\"p-6 text-center text-white/90\",role:\"status\",\"aria-live\":\"polite\",children:\"Loading messages\\u2026\"}):err?/*#__PURE__*/_jsxs(Card,{className:\"p-6 text-center text-red-200 border-red-300/40 bg-red-900/20\",children:[err,\" \\u2014 please refresh.\"]}):messages.length===0?/*#__PURE__*/_jsxs(Card,{className:\"p-6 text-center text-white/90\",children:[\"No messages yet. Be the first to\",\" \",/*#__PURE__*/_jsx(\"a\",{className:\"underline\",href:\"/leave-a-message\",children:\"leave a message\"}),\"!\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:visible.map(m=>/*#__PURE__*/_jsxs(Card,{className:\"p-4 text-white\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white/95 transition-[max-height] \".concat(expandedId===m.id?\"\":\"line-clamp-3\"),children:m.text}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 items-center justify-between mt-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-white/70\",title:new Date(m.created_at).toLocaleString(),children:[new Date(m.created_at).toLocaleDateString(),\" \",new Date(m.created_at).toLocaleTimeString([],{hour:\"2-digit\",minute:\"2-digit\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-outline\",onClick:()=>toggle(m.id),\"aria-expanded\":expandedId===m.id?\"true\":\"false\",\"aria-controls\":\"msg-\".concat(m.id),children:expandedId===m.id?\"Collapse\":\"Expand\"})]})]},m.id))}),hasMore&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:()=>setPage(p=>p+1),\"aria-label\":\"Load more messages\",children:\"Load more\"})})]})]})});}","map":{"version":3,"names":["useEffect","useMemo","useState","supabase","Backdrop","Card","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PAGE_SIZE","MessageWallPage","messages","setMessages","expandedId","setExpandedId","loading","setLoading","err","setErr","page","setPage","mounted","data","error","from","select","eq","order","ascending","message","Array","isArray","visible","end","slice","toggle","id","cur","hasMore","length","children","className","role","href","map","m","concat","text","title","Date","created_at","toLocaleString","toLocaleDateString","toLocaleTimeString","hour","minute","onClick","p"],"sources":["C:/Users/drago/OneDrive/Desktop/sussa-troue/src/pages/MessageWallPage.jsx"],"sourcesContent":["// File: src/pages/MessageWallPage.jsx\nimport { useEffect, useMemo, useState } from \"react\";\nimport { supabase } from \"../supabaseClient\";\nimport Backdrop from \"../components/Backdrop\";\nimport Card from \"../components/Card\";\n\nconst PAGE_SIZE = 20;\n\nexport default function MessageWallPage() {\n  const [messages, setMessages] = useState([]);\n  const [expandedId, setExpandedId] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [err, setErr] = useState(\"\");\n  const [page, setPage] = useState(1);\n\n  useEffect(() => {\n    let mounted = true;\n    (async () => {\n      setLoading(true);\n      const { data, error } = await supabase\n        .from(\"guest_messages\")\n        .select(\"*\")\n        .eq(\"approved\", true)\n        .eq(\"is_public\", true)\n        .order(\"created_at\", { ascending: false });\n      if (!mounted) return;\n      if (error) {\n        setErr(error.message || \"Failed to load messages.\");\n        setMessages([]);\n      } else {\n        setMessages(Array.isArray(data) ? data : []);\n      }\n      setLoading(false);\n    })();\n    return () => {\n      mounted = false;\n    };\n  }, []);\n\n  const visible = useMemo(() => {\n    const end = page * PAGE_SIZE;\n    return messages.slice(0, end);\n  }, [messages, page]);\n\n  const toggle = (id) => {\n    setExpandedId((cur) => (cur === id ? null : id));\n  };\n\n  const hasMore = messages.length > visible.length;\n\n  return (\n    <Backdrop>\n      <div className=\"max-w-4xl mx-auto px-4 py-10\">\n        <header className=\"my-6 text-center text-white\">\n          <h1 className=\"text-3xl font-extrabold\">Message Wall ðŸŒ»</h1>\n          <p className=\"text-white/80\">Warm wishes from friends &amp; family</p>\n        </header>\n\n        {loading ? (\n          <Card className=\"p-6 text-center text-white/90\" role=\"status\" aria-live=\"polite\">\n            Loading messagesâ€¦\n          </Card>\n        ) : err ? (\n          <Card className=\"p-6 text-center text-red-200 border-red-300/40 bg-red-900/20\">\n            {err} â€” please refresh.\n          </Card>\n        ) : messages.length === 0 ? (\n          <Card className=\"p-6 text-center text-white/90\">\n            No messages yet. Be the first to{\" \"}\n            <a className=\"underline\" href=\"/leave-a-message\">\n              leave a message\n            </a>\n            !\n          </Card>\n        ) : (\n          <>\n            <div className=\"space-y-3\">\n              {visible.map((m) => (\n                <Card key={m.id} className=\"p-4 text-white\">\n                  <p\n                    className={`text-white/95 transition-[max-height] ${\n                      expandedId === m.id ? \"\" : \"line-clamp-3\"\n                    }`}\n                  >\n                    {m.text}\n                  </p>\n                  <div className=\"flex flex-wrap gap-2 items-center justify-between mt-3\">\n                    <span\n                      className=\"text-xs text-white/70\"\n                      title={new Date(m.created_at).toLocaleString()}\n                    >\n                      {new Date(m.created_at).toLocaleDateString()}{\" \"}\n                      {new Date(m.created_at).toLocaleTimeString([], {\n                        hour: \"2-digit\",\n                        minute: \"2-digit\",\n                      })}\n                    </span>\n\n                    <button\n                      className=\"btn-outline\"\n                      onClick={() => toggle(m.id)}\n                      aria-expanded={expandedId === m.id ? \"true\" : \"false\"}\n                      aria-controls={`msg-${m.id}`}\n                    >\n                      {expandedId === m.id ? \"Collapse\" : \"Expand\"}\n                    </button>\n                  </div>\n                </Card>\n              ))}\n            </div>\n\n            {hasMore && (\n              <div className=\"mt-6 flex justify-center\">\n                <button\n                  className=\"btn-primary\"\n                  onClick={() => setPage((p) => p + 1)}\n                  aria-label=\"Load more messages\"\n                >\n                  Load more\n                </button>\n              </div>\n            )}\n          </>\n        )}\n      </div>\n    </Backdrop>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}