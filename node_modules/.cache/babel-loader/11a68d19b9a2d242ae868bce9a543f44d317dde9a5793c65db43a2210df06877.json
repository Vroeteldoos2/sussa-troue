{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\drago\\\\OneDrive\\\\Desktop\\\\sussa-troue\\\\src\\\\pages\\\\WeddingAlbumPage.jsx\",\n  _s = $RefreshSig$();\n// File: src/pages/WeddingAlbumPage.jsx\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport dayjs from \"dayjs\";\n\n// --- ENV FOLDERS (from your .env) ---\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst fromEnv = v => v ? String(v).split(\"#\")[0].replace(/^[\"']|[\"']$/g, \"\").trim() : \"\";\nconst PHOTOS_FOLDER = fromEnv(process.env.REACT_APP_DRIVE_PHOTOS_FOLDER_ID);\nconst VIDEOS_FOLDER = fromEnv(process.env.REACT_APP_DRIVE_VIDEOS_FOLDER_ID);\nconst API_KEY = fromEnv(process.env.REACT_APP_GOOGLE_API_KEY);\nconst CLIENT_ID = fromEnv(process.env.REACT_APP_GOOGLE_CLIENT_ID);\nconst BG_URL = \"https://cyxeucwesqzwlisgveiz.supabase.co/storage/v1/object/public/public-assets/flowers-8309997.jpg\";\nconst PAGE_SIZE = 48; // Drive returns up to 1000; we page for UX\nconst SCOPES = \"https://www.googleapis.com/auth/drive.readonly\";\n\n// ---------------- Google API helpers ----------------\nfunction loadScript(src) {\n  return new Promise((resolve, reject) => {\n    if (document.querySelector(`script[src=\"${src}\"]`)) return resolve();\n    const s = document.createElement(\"script\");\n    s.src = src;\n    s.async = true;\n    s.onload = resolve;\n    s.onerror = () => reject(new Error(`Failed to load ${src}`));\n    document.head.appendChild(s);\n  });\n}\nasync function ensureGoogleApis() {\n  await loadScript(\"https://accounts.google.com/gsi/client\"); // GIS OAuth\n  await loadScript(\"https://apis.google.com/js/api.js\"); // gapi client\n  await new Promise(resolve => {\n    var _window$gapi;\n    if ((_window$gapi = window.gapi) !== null && _window$gapi !== void 0 && _window$gapi.load) return resolve();\n    const t = setInterval(() => {\n      var _window$gapi2;\n      if ((_window$gapi2 = window.gapi) !== null && _window$gapi2 !== void 0 && _window$gapi2.load) {\n        clearInterval(t);\n        resolve();\n      }\n    }, 20);\n  });\n  await new Promise(resolve => window.gapi.load(\"client\", resolve));\n  await window.gapi.client.init({\n    apiKey: API_KEY,\n    discoveryDocs: [\"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\"]\n  });\n}\nfunction inferType(mime, name = \"\") {\n  const m = (mime || \"\").toLowerCase();\n  if (m.startsWith(\"image/\")) return \"image\";\n  if (m.startsWith(\"video/\")) return \"video\";\n  if (/\\.(png|jpe?g|gif|webp|bmp|heic)$/i.test(name)) return \"image\";\n  if (/\\.(mp4|mov|webm|mkv|avi)$/i.test(name)) return \"video\";\n  return \"file\";\n}\nfunction toPreviewURL(fileId) {\n  // Lightweight inline preview for images; for videos/open, use webViewLink\n  return `https://drive.google.com/uc?export=view&id=${fileId}`;\n}\n\n// ---------------- Page ----------------\nexport default function WeddingAlbumPage() {\n  _s();\n  const [items, setItems] = useState([]); // flattened list from both folders\n  const [nextPhotos, setNextPhotos] = useState(null); // Drive nextPageToken per folder\n  const [nextVideos, setNextVideos] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [loadErr, setLoadErr] = useState(\"\");\n  const [hasMore, setHasMore] = useState(true);\n  const tokenClientRef = useRef(null);\n  const [ready, setReady] = useState(false);\n\n  // init Google APIs\n  useEffect(() => {\n    (async () => {\n      try {\n        if (!API_KEY || !CLIENT_ID || !PHOTOS_FOLDER || !VIDEOS_FOLDER) return;\n        await ensureGoogleApis();\n        setReady(true);\n      } catch (e) {\n        setLoadErr((e === null || e === void 0 ? void 0 : e.message) || \"Could not initialize Google APIs.\");\n      }\n    })();\n  }, []);\n\n  // OAuth helper\n  const getAccessToken = useCallback(() => {\n    return new Promise((resolve, reject) => {\n      try {\n        if (!tokenClientRef.current) {\n          tokenClientRef.current = window.google.accounts.oauth2.initTokenClient({\n            client_id: CLIENT_ID,\n            scope: SCOPES,\n            callback: resp => {\n              if (resp.error) reject(resp);else resolve(resp.access_token);\n            }\n          });\n        } else {\n          tokenClientRef.current.callback = resp => {\n            if (resp.error) reject(resp);else resolve(resp.access_token);\n          };\n        }\n        tokenClientRef.current.requestAccessToken({\n          prompt: \"\"\n        });\n      } catch (e) {\n        reject(e);\n      }\n    });\n  }, []);\n\n  // Load a single folder page\n  const fetchFolderPage = useCallback(async (folderId, pageToken) => {\n    const q = `'${folderId}' in parents and trashed = false`;\n    const fields = \"nextPageToken, files(id,name,mimeType,createdTime,owners(displayName),thumbnailLink,webViewLink)\";\n    const resp = await window.gapi.client.drive.files.list({\n      q,\n      pageSize: PAGE_SIZE,\n      fields,\n      orderBy: \"createdTime desc\",\n      pageToken: pageToken || undefined,\n      includeItemsFromAllDrives: true,\n      supportsAllDrives: true\n    });\n    const files = resp.result.files || [];\n    return {\n      files,\n      nextPageToken: resp.result.nextPageToken || null\n    };\n  }, []);\n\n  // Combine next page from both folders\n  const loadMore = useCallback(async () => {\n    if (loading || !ready || !hasMore) return;\n    setLoading(true);\n    setLoadErr(\"\");\n    try {\n      await getAccessToken(); // ensures we have a token (gapi client uses it)\n      // fetch photos and videos in parallel\n      const [ph, vd] = await Promise.all([fetchFolderPage(PHOTOS_FOLDER, nextPhotos), fetchFolderPage(VIDEOS_FOLDER, nextVideos)]);\n      setNextPhotos(ph.nextPageToken);\n      setNextVideos(vd.nextPageToken);\n\n      // normalize & merge\n      const merged = [...ph.files, ...vd.files].map(f => {\n        var _f$owners$;\n        return {\n          id: f.id,\n          drive_name: f.name,\n          mimeType: f.mimeType,\n          media_type: inferType(f.mimeType, f.name),\n          created_at: f.createdTime,\n          uploader_name: f.owners && ((_f$owners$ = f.owners[0]) === null || _f$owners$ === void 0 ? void 0 : _f$owners$.displayName) || \"Guest\",\n          preview_url: inferType(f.mimeType, f.name) === \"image\" ? toPreviewURL(f.id) : f.webViewLink,\n          webViewLink: f.webViewLink,\n          thumbnail: f.thumbnailLink\n        };\n      }).sort((a, b) => a.created_at < b.created_at ? 1 : -1); // newest first\n\n      setItems(prev => {\n        const byId = new Map(prev.map(x => [x.id, x]));\n        for (const m of merged) byId.set(m.id, m); // de-dupe if a file lives in both lists (unlikely)\n        return Array.from(byId.values()).sort((a, b) => a.created_at < b.created_at ? 1 : -1);\n      });\n      if (!ph.nextPageToken && !vd.nextPageToken) setHasMore(false);\n    } catch (e) {\n      setLoadErr((e === null || e === void 0 ? void 0 : e.message) || \"Could not load album.\");\n    } finally {\n      setLoading(false);\n    }\n  }, [fetchFolderPage, getAccessToken, hasMore, loading, nextPhotos, nextVideos, ready]);\n\n  // initial load\n  useEffect(() => {\n    if (ready && items.length === 0) loadMore();\n    // eslint-disable-next-line\n  }, [ready]);\n\n  // infinite scroll\n  useEffect(() => {\n    const onScroll = () => {\n      const nearBottom = window.innerHeight + window.scrollY >= document.body.offsetHeight - 300;\n      if (nearBottom) loadMore();\n    };\n    window.addEventListener(\"scroll\", onScroll);\n    return () => window.removeEventListener(\"scroll\", onScroll);\n  }, [loadMore]);\n\n  // auto-refresh every 30s for new uploads\n  useEffect(() => {\n    if (!ready) return;\n    const t = setInterval(() => {\n      // reset paging tokens so we re-walk from the top\n      setNextPhotos(null);\n      setNextVideos(null);\n      setHasMore(true);\n      setItems([]);\n      loadMore();\n    }, 30000);\n    return () => clearInterval(t);\n  }, [ready, loadMore]);\n\n  // group by date\n  const groups = useMemo(() => {\n    const map = {};\n    for (const it of items) {\n      const key = dayjs(it.created_at).format(\"YYYY-MM-DD\");\n      (map[key] ||= []).push(it);\n    }\n    return Object.entries(map).sort(([a], [b]) => a < b ? 1 : -1);\n  }, [items]);\n  return /*#__PURE__*/_jsxDEV(Backdrop, {\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"mb-6 flex items-center justify-between gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"section-title\",\n            children: \"Wedding Album\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-soil-700\",\n            children: \"Live from Google Drive \\u2014 refreshes automatically every 30 seconds.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-outline\",\n            onClick: () => {\n              // manual refresh\n              setNextPhotos(null);\n              setNextVideos(null);\n              setHasMore(true);\n              setItems([]);\n              loadMore();\n            },\n            children: \"Refresh\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this), !API_KEY || !CLIENT_ID ? /*#__PURE__*/_jsxDEV(Warn, {\n        children: \"Missing Google API env vars. Set REACT_APP_GOOGLE_API_KEY and REACT_APP_GOOGLE_CLIENT_ID, then restart.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 11\n      }, this) : !PHOTOS_FOLDER || !VIDEOS_FOLDER ? /*#__PURE__*/_jsxDEV(Warn, {\n        children: \"Missing Drive folder IDs. Set REACT_APP_DRIVE_PHOTOS_FOLDER_ID and REACT_APP_DRIVE_VIDEOS_FOLDER_ID, then restart.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 11\n      }, this) : null, loadErr && /*#__PURE__*/_jsxDEV(ErrorBanner, {\n        children: loadErr\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 21\n      }, this), items.length === 0 && !loading && !loadErr && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-soil-700\",\n        children: \"No media yet. New uploads will appear here automatically.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-8\",\n        children: groups.map(([date, arr]) => /*#__PURE__*/_jsxDEV(\"section\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-lg font-semibold text-soil-800 mb-3\",\n            children: dayjs(date).format(\"DD MMM YYYY\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3\",\n            children: arr.map(it => /*#__PURE__*/_jsxDEV(AlbumCard, {\n              item: it\n            }, it.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 15\n          }, this)]\n        }, date, true, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6 text-soil-600\",\n        children: \"Loading\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 21\n      }, this), !loading && hasMore && items.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center mt-6\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-outline\",\n          onClick: loadMore,\n          children: \"Load more\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 11\n      }, this), !hasMore && items.length > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6 text-soil-600\",\n        children: \"End of album.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 215,\n    columnNumber: 5\n  }, this);\n}\n_s(WeddingAlbumPage, \"Zn3G3nXXDlIFwfPhX9bAZumLsb8=\");\n_c = WeddingAlbumPage;\nfunction AlbumCard({\n  item\n}) {\n  const {\n    media_type,\n    preview_url,\n    drive_name,\n    uploader_name,\n    created_at,\n    webViewLink\n  } = item;\n  const title = `${drive_name} — Uploaded by ${uploader_name}`;\n  const time = dayjs(created_at).format(\"HH:mm\");\n  const href = media_type === \"image\" ? preview_url : webViewLink;\n  return /*#__PURE__*/_jsxDEV(\"a\", {\n    href: href,\n    target: \"_blank\",\n    rel: \"noreferrer\",\n    className: \"block group rounded-xl overflow-hidden bg-white/70 border border-white/60 hover:bg-white/80 transition\",\n    title: title,\n    children: [media_type === \"image\" ? /*#__PURE__*/_jsxDEV(\"img\", {\n      src: preview_url,\n      alt: drive_name,\n      className: \"w-full h-40 object-cover group-hover:opacity-90\",\n      loading: \"lazy\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 9\n    }, this) : media_type === \"video\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full h-40 flex items-center justify-center text-sm text-soil-700\",\n      children: \"Open video \\u2197\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full h-40 flex items-center justify-center text-sm text-soil-600\",\n      children: \"Open file \\u2197\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-2 text-xs text-soil-700 flex justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"truncate\",\n        children: uploader_name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: time\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 282,\n    columnNumber: 5\n  }, this);\n}\n\n/** UI helpers */\n_c2 = AlbumCard;\nfunction Warn({\n  children\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-sm text-amber-700 bg-amber-50 border border-amber-200 rounded-md p-2 mb-4\",\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 316,\n    columnNumber: 5\n  }, this);\n}\n_c3 = Warn;\nfunction ErrorBanner({\n  children\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-sm text-red-700 bg-red-50 border border-red-200 rounded-md p-2 mb-4\",\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 324,\n    columnNumber: 5\n  }, this);\n}\n_c4 = ErrorBanner;\nfunction Backdrop({\n  children\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen w-full bg-center bg-cover relative\",\n    style: {\n      backgroundImage: `url(${BG_URL})`\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute inset-0 bg-black/30 backdrop-blur-[1px]\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative z-10 max-w-6xl mx-auto px-4 py-10\",\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 332,\n    columnNumber: 5\n  }, this);\n}\n_c5 = Backdrop;\nfunction Card({\n  children,\n  className = \"\"\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `bg-white/85 rounded-2xl shadow-xl border border-white/60 p-6 md:p-8 ${className}`,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 344,\n    columnNumber: 5\n  }, this);\n}\n_c6 = Card;\nvar _c, _c2, _c3, _c4, _c5, _c6;\n$RefreshReg$(_c, \"WeddingAlbumPage\");\n$RefreshReg$(_c2, \"AlbumCard\");\n$RefreshReg$(_c3, \"Warn\");\n$RefreshReg$(_c4, \"ErrorBanner\");\n$RefreshReg$(_c5, \"Backdrop\");\n$RefreshReg$(_c6, \"Card\");","map":{"version":3,"names":["useCallback","useEffect","useMemo","useRef","useState","dayjs","jsxDEV","_jsxDEV","fromEnv","v","String","split","replace","trim","PHOTOS_FOLDER","process","env","REACT_APP_DRIVE_PHOTOS_FOLDER_ID","VIDEOS_FOLDER","REACT_APP_DRIVE_VIDEOS_FOLDER_ID","API_KEY","REACT_APP_GOOGLE_API_KEY","CLIENT_ID","REACT_APP_GOOGLE_CLIENT_ID","BG_URL","PAGE_SIZE","SCOPES","loadScript","src","Promise","resolve","reject","document","querySelector","s","createElement","async","onload","onerror","Error","head","appendChild","ensureGoogleApis","_window$gapi","window","gapi","load","t","setInterval","_window$gapi2","clearInterval","client","init","apiKey","discoveryDocs","inferType","mime","name","m","toLowerCase","startsWith","test","toPreviewURL","fileId","WeddingAlbumPage","_s","items","setItems","nextPhotos","setNextPhotos","nextVideos","setNextVideos","loading","setLoading","loadErr","setLoadErr","hasMore","setHasMore","tokenClientRef","ready","setReady","e","message","getAccessToken","current","google","accounts","oauth2","initTokenClient","client_id","scope","callback","resp","error","access_token","requestAccessToken","prompt","fetchFolderPage","folderId","pageToken","q","fields","drive","files","list","pageSize","orderBy","undefined","includeItemsFromAllDrives","supportsAllDrives","result","nextPageToken","loadMore","ph","vd","all","merged","map","f","_f$owners$","id","drive_name","mimeType","media_type","created_at","createdTime","uploader_name","owners","displayName","preview_url","webViewLink","thumbnail","thumbnailLink","sort","a","b","prev","byId","Map","x","set","Array","from","values","length","onScroll","nearBottom","innerHeight","scrollY","body","offsetHeight","addEventListener","removeEventListener","groups","it","key","format","push","Object","entries","Backdrop","children","Card","className","fileName","_jsxFileName","lineNumber","columnNumber","onClick","Warn","ErrorBanner","date","arr","AlbumCard","item","_c","title","time","href","target","rel","alt","_c2","_c3","_c4","style","backgroundImage","_c5","_c6","$RefreshReg$"],"sources":["C:/Users/drago/OneDrive/Desktop/sussa-troue/src/pages/WeddingAlbumPage.jsx"],"sourcesContent":["// File: src/pages/WeddingAlbumPage.jsx\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport dayjs from \"dayjs\";\n\n// --- ENV FOLDERS (from your .env) ---\nconst fromEnv = (v) => (v ? String(v).split(\"#\")[0].replace(/^[\"']|[\"']$/g, \"\").trim() : \"\");\nconst PHOTOS_FOLDER = fromEnv(process.env.REACT_APP_DRIVE_PHOTOS_FOLDER_ID);\nconst VIDEOS_FOLDER = fromEnv(process.env.REACT_APP_DRIVE_VIDEOS_FOLDER_ID);\nconst API_KEY = fromEnv(process.env.REACT_APP_GOOGLE_API_KEY);\nconst CLIENT_ID = fromEnv(process.env.REACT_APP_GOOGLE_CLIENT_ID);\n\nconst BG_URL =\n  \"https://cyxeucwesqzwlisgveiz.supabase.co/storage/v1/object/public/public-assets/flowers-8309997.jpg\";\n\nconst PAGE_SIZE = 48; // Drive returns up to 1000; we page for UX\nconst SCOPES = \"https://www.googleapis.com/auth/drive.readonly\";\n\n// ---------------- Google API helpers ----------------\nfunction loadScript(src) {\n  return new Promise((resolve, reject) => {\n    if (document.querySelector(`script[src=\"${src}\"]`)) return resolve();\n    const s = document.createElement(\"script\");\n    s.src = src;\n    s.async = true;\n    s.onload = resolve;\n    s.onerror = () => reject(new Error(`Failed to load ${src}`));\n    document.head.appendChild(s);\n  });\n}\n\nasync function ensureGoogleApis() {\n  await loadScript(\"https://accounts.google.com/gsi/client\"); // GIS OAuth\n  await loadScript(\"https://apis.google.com/js/api.js\");      // gapi client\n  await new Promise((resolve) => {\n    if (window.gapi?.load) return resolve();\n    const t = setInterval(() => {\n      if (window.gapi?.load) {\n        clearInterval(t);\n        resolve();\n      }\n    }, 20);\n  });\n  await new Promise((resolve) => window.gapi.load(\"client\", resolve));\n  await window.gapi.client.init({ apiKey: API_KEY, discoveryDocs: [\"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\"] });\n}\n\nfunction inferType(mime, name = \"\") {\n  const m = (mime || \"\").toLowerCase();\n  if (m.startsWith(\"image/\")) return \"image\";\n  if (m.startsWith(\"video/\")) return \"video\";\n  if (/\\.(png|jpe?g|gif|webp|bmp|heic)$/i.test(name)) return \"image\";\n  if (/\\.(mp4|mov|webm|mkv|avi)$/i.test(name)) return \"video\";\n  return \"file\";\n}\n\nfunction toPreviewURL(fileId) {\n  // Lightweight inline preview for images; for videos/open, use webViewLink\n  return `https://drive.google.com/uc?export=view&id=${fileId}`;\n}\n\n// ---------------- Page ----------------\nexport default function WeddingAlbumPage() {\n  const [items, setItems] = useState([]);              // flattened list from both folders\n  const [nextPhotos, setNextPhotos] = useState(null);  // Drive nextPageToken per folder\n  const [nextVideos, setNextVideos] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [loadErr, setLoadErr] = useState(\"\");\n  const [hasMore, setHasMore] = useState(true);\n  const tokenClientRef = useRef(null);\n  const [ready, setReady] = useState(false);\n\n  // init Google APIs\n  useEffect(() => {\n    (async () => {\n      try {\n        if (!API_KEY || !CLIENT_ID || !PHOTOS_FOLDER || !VIDEOS_FOLDER) return;\n        await ensureGoogleApis();\n        setReady(true);\n      } catch (e) {\n        setLoadErr(e?.message || \"Could not initialize Google APIs.\");\n      }\n    })();\n  }, []);\n\n  // OAuth helper\n  const getAccessToken = useCallback(() => {\n    return new Promise((resolve, reject) => {\n      try {\n        if (!tokenClientRef.current) {\n          tokenClientRef.current = window.google.accounts.oauth2.initTokenClient({\n            client_id: CLIENT_ID,\n            scope: SCOPES,\n            callback: (resp) => {\n              if (resp.error) reject(resp);\n              else resolve(resp.access_token);\n            },\n          });\n        } else {\n          tokenClientRef.current.callback = (resp) => {\n            if (resp.error) reject(resp);\n            else resolve(resp.access_token);\n          };\n        }\n        tokenClientRef.current.requestAccessToken({ prompt: \"\" });\n      } catch (e) {\n        reject(e);\n      }\n    });\n  }, []);\n\n  // Load a single folder page\n  const fetchFolderPage = useCallback(async (folderId, pageToken) => {\n    const q = `'${folderId}' in parents and trashed = false`;\n    const fields = \"nextPageToken, files(id,name,mimeType,createdTime,owners(displayName),thumbnailLink,webViewLink)\";\n    const resp = await window.gapi.client.drive.files.list({\n      q,\n      pageSize: PAGE_SIZE,\n      fields,\n      orderBy: \"createdTime desc\",\n      pageToken: pageToken || undefined,\n      includeItemsFromAllDrives: true,\n      supportsAllDrives: true,\n    });\n    const files = resp.result.files || [];\n    return { files, nextPageToken: resp.result.nextPageToken || null };\n  }, []);\n\n  // Combine next page from both folders\n  const loadMore = useCallback(async () => {\n    if (loading || !ready || !hasMore) return;\n    setLoading(true);\n    setLoadErr(\"\");\n\n    try {\n      await getAccessToken(); // ensures we have a token (gapi client uses it)\n      // fetch photos and videos in parallel\n      const [ph, vd] = await Promise.all([\n        fetchFolderPage(PHOTOS_FOLDER, nextPhotos),\n        fetchFolderPage(VIDEOS_FOLDER, nextVideos),\n      ]);\n\n      setNextPhotos(ph.nextPageToken);\n      setNextVideos(vd.nextPageToken);\n\n      // normalize & merge\n      const merged = [...ph.files, ...vd.files]\n        .map((f) => ({\n          id: f.id,\n          drive_name: f.name,\n          mimeType: f.mimeType,\n          media_type: inferType(f.mimeType, f.name),\n          created_at: f.createdTime,\n          uploader_name: (f.owners && f.owners[0]?.displayName) || \"Guest\",\n          preview_url: inferType(f.mimeType, f.name) === \"image\" ? toPreviewURL(f.id) : f.webViewLink,\n          webViewLink: f.webViewLink,\n          thumbnail: f.thumbnailLink,\n        }))\n        .sort((a, b) => (a.created_at < b.created_at ? 1 : -1)); // newest first\n\n      setItems((prev) => {\n        const byId = new Map(prev.map((x) => [x.id, x]));\n        for (const m of merged) byId.set(m.id, m); // de-dupe if a file lives in both lists (unlikely)\n        return Array.from(byId.values()).sort((a, b) => (a.created_at < b.created_at ? 1 : -1));\n      });\n\n      if (!ph.nextPageToken && !vd.nextPageToken) setHasMore(false);\n    } catch (e) {\n      setLoadErr(e?.message || \"Could not load album.\");\n    } finally {\n      setLoading(false);\n    }\n  }, [fetchFolderPage, getAccessToken, hasMore, loading, nextPhotos, nextVideos, ready]);\n\n  // initial load\n  useEffect(() => {\n    if (ready && items.length === 0) loadMore();\n    // eslint-disable-next-line\n  }, [ready]);\n\n  // infinite scroll\n  useEffect(() => {\n    const onScroll = () => {\n      const nearBottom = window.innerHeight + window.scrollY >= document.body.offsetHeight - 300;\n      if (nearBottom) loadMore();\n    };\n    window.addEventListener(\"scroll\", onScroll);\n    return () => window.removeEventListener(\"scroll\", onScroll);\n  }, [loadMore]);\n\n  // auto-refresh every 30s for new uploads\n  useEffect(() => {\n    if (!ready) return;\n    const t = setInterval(() => {\n      // reset paging tokens so we re-walk from the top\n      setNextPhotos(null);\n      setNextVideos(null);\n      setHasMore(true);\n      setItems([]);\n      loadMore();\n    }, 30000);\n    return () => clearInterval(t);\n  }, [ready, loadMore]);\n\n  // group by date\n  const groups = useMemo(() => {\n    const map = {};\n    for (const it of items) {\n      const key = dayjs(it.created_at).format(\"YYYY-MM-DD\");\n      (map[key] ||= []).push(it);\n    }\n    return Object.entries(map).sort(([a], [b]) => (a < b ? 1 : -1));\n  }, [items]);\n\n  return (\n    <Backdrop>\n      <Card>\n        <header className=\"mb-6 flex items-center justify-between gap-3\">\n          <div>\n            <h1 className=\"section-title\">Wedding Album</h1>\n            <p className=\"text-soil-700\">\n              Live from Google Drive — refreshes automatically every 30 seconds.\n            </p>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <button className=\"btn-outline\" onClick={() => { // manual refresh\n              setNextPhotos(null); setNextVideos(null); setHasMore(true); setItems([]); loadMore();\n            }}>\n              Refresh\n            </button>\n          </div>\n        </header>\n\n        {!API_KEY || !CLIENT_ID ? (\n          <Warn>Missing Google API env vars. Set REACT_APP_GOOGLE_API_KEY and REACT_APP_GOOGLE_CLIENT_ID, then restart.</Warn>\n        ) : !PHOTOS_FOLDER || !VIDEOS_FOLDER ? (\n          <Warn>Missing Drive folder IDs. Set REACT_APP_DRIVE_PHOTOS_FOLDER_ID and REACT_APP_DRIVE_VIDEOS_FOLDER_ID, then restart.</Warn>\n        ) : null}\n\n        {loadErr && <ErrorBanner>{loadErr}</ErrorBanner>}\n\n        {items.length === 0 && !loading && !loadErr && (\n          <p className=\"text-soil-700\">No media yet. New uploads will appear here automatically.</p>\n        )}\n\n        <div className=\"space-y-8\">\n          {groups.map(([date, arr]) => (\n            <section key={date}>\n              <h2 className=\"text-lg font-semibold text-soil-800 mb-3\">\n                {dayjs(date).format(\"DD MMM YYYY\")}\n              </h2>\n              <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3\">\n                {arr.map((it) => (\n                  <AlbumCard key={it.id} item={it} />\n                ))}\n              </div>\n            </section>\n          ))}\n        </div>\n\n        {loading && <p className=\"mt-6 text-soil-600\">Loading…</p>}\n        {!loading && hasMore && items.length > 0 && (\n          <div className=\"flex justify-center mt-6\">\n            <button className=\"btn-outline\" onClick={loadMore}>Load more</button>\n          </div>\n        )}\n        {!hasMore && items.length > 0 && (\n          <p className=\"mt-6 text-soil-600\">End of album.</p>\n        )}\n      </Card>\n    </Backdrop>\n  );\n}\n\nfunction AlbumCard({ item }) {\n  const { media_type, preview_url, drive_name, uploader_name, created_at, webViewLink } = item;\n  const title = `${drive_name} — Uploaded by ${uploader_name}`;\n  const time = dayjs(created_at).format(\"HH:mm\");\n\n  const href = media_type === \"image\" ? preview_url : webViewLink;\n\n  return (\n    <a\n      href={href}\n      target=\"_blank\"\n      rel=\"noreferrer\"\n      className=\"block group rounded-xl overflow-hidden bg-white/70 border border-white/60 hover:bg-white/80 transition\"\n      title={title}\n    >\n      {media_type === \"image\" ? (\n        <img\n          src={preview_url}\n          alt={drive_name}\n          className=\"w-full h-40 object-cover group-hover:opacity-90\"\n          loading=\"lazy\"\n        />\n      ) : media_type === \"video\" ? (\n        <div className=\"w-full h-40 flex items-center justify-center text-sm text-soil-700\">\n          Open video ↗\n        </div>\n      ) : (\n        <div className=\"w-full h-40 flex items-center justify-center text-sm text-soil-600\">\n          Open file ↗\n        </div>\n      )}\n      <div className=\"p-2 text-xs text-soil-700 flex justify-between\">\n        <span className=\"truncate\">{uploader_name}</span>\n        <span>{time}</span>\n      </div>\n    </a>\n  );\n}\n\n/** UI helpers */\nfunction Warn({ children }) {\n  return (\n    <div className=\"text-sm text-amber-700 bg-amber-50 border border-amber-200 rounded-md p-2 mb-4\">\n      {children}\n    </div>\n  );\n}\n\nfunction ErrorBanner({ children }) {\n  return (\n    <div className=\"text-sm text-red-700 bg-red-50 border border-red-200 rounded-md p-2 mb-4\">\n      {children}\n    </div>\n  );\n}\n\nfunction Backdrop({ children }) {\n  return (\n    <div\n      className=\"min-h-screen w-full bg-center bg-cover relative\"\n      style={{ backgroundImage: `url(${BG_URL})` }}\n    >\n      <div className=\"absolute inset-0 bg-black/30 backdrop-blur-[1px]\" />\n      <div className=\"relative z-10 max-w-6xl mx-auto px-4 py-10\">{children}</div>\n    </div>\n  );\n}\n\nfunction Card({ children, className = \"\" }) {\n  return (\n    <div className={`bg-white/85 rounded-2xl shadow-xl border border-white/60 p-6 md:p-8 ${className}`}>\n      {children}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}