{"ast":null,"code":"// File: src/pages/LoginPage.jsx\nimport{useState}from\"react\";import{toast}from\"react-hot-toast\";import{Link,useNavigate}from\"react-router-dom\";import AuthLayout from\"../components/AuthLayout\";import{AUTH_SLIDES,AUTH_CAPTIONS}from\"./_authAssets\";import{supabase}from\"../supabaseClient\";// âœ… Route based on whether an RSVP exists\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";async function routeByRsvp(email,navigate){try{const clean=(email||\"\").trim().toLowerCase();if(!clean){navigate(\"/rsvp\",{replace:true});return;}const{data,error}=await supabase.from(\"rsvps\").select(\"id\").eq(\"email\",clean).limit(1);if(error)throw error;// IMPORTANT: App.jsx uses /view-rsvp (not /my-rsvp)\nnavigate((data===null||data===void 0?void 0:data.length)>0?\"/view-rsvp\":\"/rsvp\",{replace:true});}catch(_unused){navigate(\"/rsvp\",{replace:true});}}export default function LoginPage(){const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[showPw,setShowPw]=useState(false);const[loading,setLoading]=useState(false);const[formErr,setFormErr]=useState(\"\");const navigate=useNavigate();const submit=async e=>{e.preventDefault();setFormErr(\"\");if(!email||!password){setFormErr(\"Please enter both email and password.\");return;}setLoading(true);try{const{error}=await supabase.auth.signInWithPassword({email:email.trim(),password});if(error)throw error;toast.success(\"Logged in!\");await routeByRsvp(email,navigate);}catch(err){const msg=(err===null||err===void 0?void 0:err.message)||\"Login failed. Please try again.\";setFormErr(msg);toast.error(msg);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(AuthLayout,{slides:AUTH_SLIDES,captions:AUTH_CAPTIONS,children:[/*#__PURE__*/_jsx(\"h1\",{className:\"section-title text-center\",children:\"Welcome \\uD83C\\uDF3B\"}),!!formErr&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-2\",role:\"alert\",children:formErr}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submit,className:\"mt-4 space-y-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block\",htmlFor:\"login_email\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{id:\"login_email\",className:\"input\",type:\"email\",placeholder:\"Email\",autoComplete:\"email\",value:email,onChange:e=>setEmail(e.target.value),disabled:loading,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"block relative\",htmlFor:\"login_password\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{id:\"login_password\",className:\"input pr-12\",type:showPw?\"text\":\"password\",placeholder:\"Password\",autoComplete:\"current-password\",value:password,onChange:e=>setPassword(e.target.value),disabled:loading,required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"absolute right-2 top-1/2 -translate-y-1/2 text-sm text-soil-600 hover:underline\",onClick:()=>setShowPw(s=>!s),\"aria-pressed\":showPw?\"true\":\"false\",tabIndex:0,children:showPw?\"Hide\":\"Show\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary w-full\",type:\"submit\",disabled:loading,children:loading?\"Signing inâ€¦\":\"Login\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-sm mt-2\",children:[/*#__PURE__*/_jsx(Link,{to:\"/signup\",className:\"text-soil-700 hover:underline\",children:\"Create account\"}),/*#__PURE__*/_jsx(Link,{to:\"/reset\",className:\"text-soil-700 hover:underline\",children:\"Forgot password?\"})]})]})]});}","map":{"version":3,"names":["useState","toast","Link","useNavigate","AuthLayout","AUTH_SLIDES","AUTH_CAPTIONS","supabase","jsx","_jsx","jsxs","_jsxs","routeByRsvp","email","navigate","clean","trim","toLowerCase","replace","data","error","from","select","eq","limit","length","_unused","LoginPage","setEmail","password","setPassword","showPw","setShowPw","loading","setLoading","formErr","setFormErr","submit","e","preventDefault","auth","signInWithPassword","success","err","msg","message","slides","captions","children","className","role","onSubmit","htmlFor","id","type","placeholder","autoComplete","value","onChange","target","disabled","required","onClick","s","tabIndex","to"],"sources":["C:/Users/drago/OneDrive/Desktop/sussa-troue/src/pages/LoginPage.jsx"],"sourcesContent":["// File: src/pages/LoginPage.jsx\nimport { useState } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport AuthLayout from \"../components/AuthLayout\";\nimport { AUTH_SLIDES, AUTH_CAPTIONS } from \"./_authAssets\";\nimport { supabase } from \"../supabaseClient\";\n\n// âœ… Route based on whether an RSVP exists\nasync function routeByRsvp(email, navigate) {\n  try {\n    const clean = (email || \"\").trim().toLowerCase();\n    if (!clean) {\n      navigate(\"/rsvp\", { replace: true });\n      return;\n    }\n    const { data, error } = await supabase\n      .from(\"rsvps\")\n      .select(\"id\")\n      .eq(\"email\", clean)\n      .limit(1);\n    if (error) throw error;\n\n    // IMPORTANT: App.jsx uses /view-rsvp (not /my-rsvp)\n    navigate(data?.length > 0 ? \"/view-rsvp\" : \"/rsvp\", { replace: true });\n  } catch {\n    navigate(\"/rsvp\", { replace: true });\n  }\n}\n\nexport default function LoginPage() {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showPw, setShowPw] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [formErr, setFormErr] = useState(\"\");\n  const navigate = useNavigate();\n\n  const submit = async (e) => {\n    e.preventDefault();\n    setFormErr(\"\");\n    if (!email || !password) {\n      setFormErr(\"Please enter both email and password.\");\n      return;\n    }\n    setLoading(true);\n    try {\n      const { error } = await supabase.auth.signInWithPassword({\n        email: email.trim(),\n        password,\n      });\n      if (error) throw error;\n\n      toast.success(\"Logged in!\");\n      await routeByRsvp(email, navigate);\n    } catch (err) {\n      const msg = err?.message || \"Login failed. Please try again.\";\n      setFormErr(msg);\n      toast.error(msg);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <AuthLayout slides={AUTH_SLIDES} captions={AUTH_CAPTIONS}>\n      <h1 className=\"section-title text-center\">Welcome ðŸŒ»</h1>\n\n      {!!formErr && (\n        <div\n          className=\"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-2\"\n          role=\"alert\"\n        >\n          {formErr}\n        </div>\n      )}\n\n      <form onSubmit={submit} className=\"mt-4 space-y-3\">\n        <label className=\"block\" htmlFor=\"login_email\">\n          <span className=\"sr-only\">Email</span>\n          <input\n            id=\"login_email\"\n            className=\"input\"\n            type=\"email\"\n            placeholder=\"Email\"\n            autoComplete=\"email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n            disabled={loading}\n            required\n          />\n        </label>\n\n        <label className=\"block relative\" htmlFor=\"login_password\">\n          <span className=\"sr-only\">Password</span>\n          <input\n            id=\"login_password\"\n            className=\"input pr-12\"\n            type={showPw ? \"text\" : \"password\"}\n            placeholder=\"Password\"\n            autoComplete=\"current-password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            disabled={loading}\n            required\n          />\n          <button\n            type=\"button\"\n            className=\"absolute right-2 top-1/2 -translate-y-1/2 text-sm text-soil-600 hover:underline\"\n            onClick={() => setShowPw((s) => !s)}\n            aria-pressed={showPw ? \"true\" : \"false\"}\n            tabIndex={0}\n          >\n            {showPw ? \"Hide\" : \"Show\"}\n          </button>\n        </label>\n\n        <button className=\"btn-primary w-full\" type=\"submit\" disabled={loading}>\n          {loading ? \"Signing inâ€¦\" : \"Login\"}\n        </button>\n\n        <div className=\"flex items-center justify-between text-sm mt-2\">\n          <Link to=\"/signup\" className=\"text-soil-700 hover:underline\">\n            Create account\n          </Link>\n          <Link to=\"/reset\" className=\"text-soil-700 hover:underline\">\n            Forgot password?\n          </Link>\n        </div>\n      </form>\n    </AuthLayout>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}